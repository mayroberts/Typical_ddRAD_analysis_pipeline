# Data pre processing 

- [Renaming files: adding a prefix to differentiate same sample-different run](#renaming-files-adding-a-prefix-to-differentiate-same-sample-different-run)
- [Renaming files for consistency](#renaming-files-for-consistency-so-we-can-code-our-sequence-choice-based-on-site)

## Renaming files: adding a prefix to differentiate same sample-different run

We had some rough sequences from plate 1, 2, and so we resequenced some of those individuals in plate 3. The first run of plate 3 had low output and has to be rerun again. This means, for some samples, we have up to 3 sequences that will need to be merged. Some with different file neames (between plates 1,2,and 3) and some with the exact same name. To make things easier down the line when we get the 2nd run of plate 3 back with the extact same name, I am adding a prefix to the files from the first run of plate3.

        Plate_3_reseqs 	                                    Plate_1_2_duplicate_samples
        Sibara_filifolia_SNK126_9614_SCa_Bunkers2	Sibara_filifolia_HES_SIFI126_Bunkers2_9614
        Sibara_filifolia_KMM57_9553_SCa_WBG3	        Sibara_filifolia_KMM_SIFI57_9553
        Sibara_filifolia_KMM62_9558_SCa_WBG5	        Sibara_filifolia_KMM_SIFI62_9558
        Sibara_filifolia_AJC_9654_SCl_1	                Sibara_filifolia_AJC_Z1_1_9654
        Sibara_filifolia_AJC_9656_SCl_1	                Sibara_filifolia_AJC_Z1_3_9656
        Sibara_filifolia_SNK3_10290_SCl_1	        Sibara_filifolia_SNK_Z1_S3_10290
        Sibara_filifolia_SNKML16_10268_SCl_2	        Sibara_filifolia_SNKZ2_S11_10268
        Sibara_filifolia_SNKML8_10270_SCl_2	        Sibara_filifolia_SNK_Z2_S12_10270
        Sibara_filifolia_SNKML3_10273_SCl_2	        Sibara_filifolia_SNK_Z2_S14_10273
        Sibara_filifolia_SNKML2_10274_SCl_2	        Sibara_filifolia_SNK_Z2_S13_10274
        Sibara_filifolia_AJK_9664_SCl_3	                Sibara_filifolia_AJK_Z3_1_9664
        Sibara_filifolia_ML17_10119_SCl_3	        Sibara_filifolia_KHL_299_ML17_Z3_10119
        Sibara_filifolia_KHLM36_9645_SCl_4	        Sibara_filifolia_KHL_Z4_10_9645
        Sibara_filifolia_KHL_9648_SCl_4	               Sibara_filifolia_KHL_Z4_13_9648
        Sibara_filifolia_KHLML34_10277_SCl_4	        Sibara_filifolia_KHL_Z4_4_10277
        Sibara_filifolia_KHLML12_10279_SCl_4	        Sibara_filifolia_KHL_Z4_14_10279
        Sibara_filifolia_KHLML13_10280_SCl_4	        Sibara_filifolia_KHL_Z4_17_10280
        Sibara_filifolia_SNKML14_10285_SCl_4	        Sibara_filifolia_SNK_Z4_ML14_10285
        Sibara_filifolia_SNKML21_10289_SCl_4 oops cat and deleted this original file 	Sibara_filifolia_SNK_Z4_S32_10289
        Sibara_filifolia_RJJ_10262_SCl_6	        Sibara_filifolia_RJJ_Z6_2_10262
        Sibara_filifolia_RJJ_10263_SCl_6	        Sibara_filifolia_RJJ_Z6_3_10263
        Sibara_filifolia_RJJ_10266_SCl_6	        Sibara_filifolia_RJJ_Z6_6_10266

### Adding a prefix to all plate 3 files 
All these files are in the same directory, before we put them in the raw_data directory

    for file in *.fastq.gz; 
    do
    mv $file ./"pl3a_""$file"; 
    done

Once all the plate 3 files have been renamed to have a pl3a prefix, I moved them to join all the other sequences in the raw_data directory

### Merging sample files by shared extraction number
If you had a quick way to do it you could make a list of the extraction numbers and then make a for loop to do this but with only ~20 merges to do I figured doing them one by one would overall be faster. 

First I moved all the files meeding merging into a directory I made called `merg_room`, again if you had a quick list of the extraction numbers a loop would be great for this.

    mv *extraction#* /merg_room

Then for each pair of files that share an extraction #:

    cat *extraction#* > New_name  # I just took the name of one of the files and added "cat" just after the extraction number



## Renaming files for consistency so we can code our sequence choice based on site
In order to more easily pick out the correct sequence files based on their sites/islands, I am renaming many of my sequneces since that info was not included on many of them or were not particularly standardized. I just made a simple bash code using a combination of excel (`=concat(mv,old_file_name_,new_filename)) and pasted the column into a code that looks like this (I didn't include all the lines). 

`rename_seq.sh`

    #!/bin/bash
    
    mv Sibara_filifolia_AJC_Z1_2_9655.fastq.gz Sibara_filifolia_AJC_Z1_2_9655_SCl_1.fastq.gz
    mv Sibara_filifolia_AJC_Z1_4_9657.fastq.gz Sibara_filifolia_AJC_Z1_4_9657_SCl_1.fastq.gz
    mv Sibara_filifolia_AJC_Z1_5_9653.fastq.gz Sibara_filifolia_AJC_Z1_5_9653_SCl_1.fastq.gz
    mv Sibara_filifolia_AJK_Z3_2_9662.fastq.gz Sibara_filifolia_AJK_Z3_2_9662_SCl_3.fastq.gz
    mv Sibara_filifolia_AJK_Z3_5_9663.fastq.gz Sibara_filifolia_AJK_Z3_5_9663_SCl_3.fastq.gz
    mv Sibara_filifolia_HES_SIF123_Bunkers2_9611.fastq.gz Sibara_filifolia_HES_SIF123_9611_SCa_Bunkers2.fastq.gz
    mv Sibara_filifolia_HES_SIFI111_9599.fastq.gz Sibara_filifolia_HES_SIFI111_9599_SCa_Bunkers2.fastq.gz
    mv Sibara_filifolia_HES_SIFI11_9483.fastq.gz Sibara_filifolia_HES_SIFI11_9483_SCa_WBG4.fastq.gz
    mv Sibara_filifolia_HES_SIFI124_Bunkers2_9612.fastq.gz Sibara_filifolia_HES_SIFI124_9612_SCa_Bunkers2.fastq.gz
    mv Sibara_filifolia_HES_SIFI128_Bunkers2_9616.fastq.gz Sibara_filifolia_HES_SIFI128_9616_SCa_Bunkers2.fastq.gz
    mv Sibara_filifolia_HES_SIFI129_Bunkers2_9617.fastq.gz Sibara_filifolia_HES_SIFI129_9617_SCa_Bunkers2.fastq.gz
    mv Sibara_filifolia_HES_SIFI12_9484.fastq.gz Sibara_filifolia_HES_SIFI12_9484_SCa_WBG4.fastq.gz
    mv Sibara_filifolia_HES_SIFI130_Bunkers2_9630.fastq.gz Sibara_filifolia_HES_SIFI130_9630_SCa_Bunkers2.fastq.gz
    mv Sibara_filifolia_HES_SIFI13_9485.fastq.gz Sibara_filifolia_HES_SIFI13_9485_SCa_WBG4.fastq.gz
    mv Sibara_filifolia_HES_SIFI14_9486.fastq.gz Sibara_filifolia_HES_SIFI14_9486_SCa_WBG4.fastq.gz
    mv Sibara_filifolia_HES_SIFI15_9487.fastq.gz Sibara_filifolia_HES_SIFI15_9487_SCa_WBG4.fastq.gz
    mv Sibara_filifolia_HES_SIFI16_9488.fastq.gz Sibara_filifolia_HES_SIFI16_9488_SCa_WBG4.fastq.gz
    mv Sibara_filifolia_HES_SIFI18_9490.fastq.gz Sibara_filifolia_HES_SIFI18_9490_SCa_WBG1.fastq.gz
    mv Sibara_filifolia_HES_SIFI44_9519.fastq.gz Sibara_filifolia_HES_SIFI44_9519_SCa_Bunkers2.fastq.gz
    mv Sibara_filifolia_KAA_SIFI22_9494.fastq.gz Sibara_filifolia_KAA_SIFI22_9494_SCa_WBG4.fastq.gz
    mv Sibara_filifolia_KAA_SIFI23_9495.fastq.gz Sibara_filifolia_KAA_SIFI23_9495_SCa_WBG4.fastq.gz
    mv Sibara_filifolia_KAA_SIFI24_9496.fastq.gz Sibara_filifolia_KAA_SIFI24_9496_SCa_WBG4.fastq.gz
    mv Sibara_filifolia_KAA_SIFI25_9497.fastq.gz Sibara_filifolia_KAA_SIFI25_9497_SCa_WBG4.fastq.gz
    mv Sibara_filifolia_KAA_SIFI26_9498.fastq.gz Sibara_filifolia_KAA_SIFI26_9498_SCa_WBG4.fastq.gz

Then, in terminal, have this `rename_seq.sh` code in the directory with the sequences (or just write in the path to the directory with the sequences). You should also do a test run with just a few sequences to make sure it's working as expected. 

    bash rename_seq.sh

Now all my sequences have the island code (either SCa_or SCl_) plus the sampling site code or name at the end of the file name. 

From here, when we make our params- file we can easily code in `*SCa_*` or `*SCl*` in the line where we direct ipyrad where the raw data is. 
